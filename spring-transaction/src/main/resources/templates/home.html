<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>ìœ ì € ê´€ë¦¬</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="/js/common.js"></script> <!-- ajaxPost í•¨ìˆ˜ ì •ì˜ë˜ì–´ ìˆì–´ì•¼ í•¨ -->
</head>
<body>

  <h2>ìœ ì € ëª©ë¡</h2>
  <button id="btnUserList">ìœ ì € ì¡°íšŒ</button>

  <div id="result"></div>

  <hr />

  <h2>ìœ ì € ì €ì¥</h2>
  <form id="userForm">
    <label>Username: <input type="text" id="username" name="username" required></label><br><br>
    <label>password: <input type="password" id="password" name="password"></label><br><br>
    <button type="button" id="btnUserSave">ìœ ì € ì €ì¥</button>
  </form>

  <div id="saveResult"></div>

  <h2>ìš”ì²­í…ŒìŠ¤íŠ¸</h2>
  <button id="btnRequest">í˜¸ì¶œ</button>

  <script>
    $(document).ready(function() {
      $("#btnUserList").on("click", btnUserList);
      $("#btnUserSave").on("click", btnUserSave);
      $("#btnRequest").on("click", btnRequest);
    });

    function btnUserList() {
      $("#result").html("â³ ìœ ì € ëª©ë¡ ì¡°íšŒ ì¤‘...");

      ajaxPost("/user/findUserList", {}, function(data) {
        let html = "<h4>ìœ ì € ëª©ë¡</h4><ul>";
        data.forEach(user => {
          html += `<li>${user.username}</li>`;
        });
        html += "</ul>";
        $("#result").html(html);
      });
    }
	
    // ì €ì¥
    function btnUserSave() {
      const userData = {
        username: $("#username").val(),
        password: $("#password").val()
      };

      // ìœ íš¨ì„± ê²€ì‚¬ (ê°„ë‹¨ ì˜ˆì‹œ)
      if (!userData.username) {
        alert("Usernameì„ ì…ë ¥í•˜ì„¸ìš”.");
        return;
      }

      $("#saveResult").html("ğŸ’¾ ì €ì¥ ì¤‘...");

      ajaxPost("/user/saveUser", userData, function(response) {
        $("#saveResult").html("âœ… ì €ì¥ ì„±ê³µ!");
        $("#userForm")[0].reset(); // í¼ ì´ˆê¸°í™”
        btnUserList(); // ì €ì¥ í›„ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
      }, function(error) {
        $("#saveResult").html("âŒ ì €ì¥ ì‹¤íŒ¨");
      });
    }
    
    // ìš”ì²­ ë²„íŠ¼
	function btnRequest() {
      ajaxPost("/request/test", {}, function(data) {
    	  console.log("data:", "", data);
      });
    }
  </script>

</body>
</html>
